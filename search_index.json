[["index.html", "医学统计学与R语言 第 1 章 简介 1.1 软件准备 1.2 致谢 1.3 声明", " 医学统计学与R语言 刘向 2021-07-04 第 1 章 简介 这份笔记主要是我个人在学习孙振球，徐勇勇老师的&lt;&gt; 第4版的过程中，尽量使用编程语言R对书中的示例进行实现的记录， 并用Bookdown形成的。 #&lt;&lt;医学统计学&gt;&gt; 孙振球, 徐勇勇. 第4版[M]. 人民卫生出版社, 2014. 虽然在学习，整理过程中尽量将笔记的形式，内容结构进行力所能及的梳理，这里要特别感谢在学习过程中，在网络上找到的一些参考资料带来的帮助，然后将一些 示例与原书进行对照，以避免一些学习错误，但个人能力和精力实在有限，也容易会有理解不当，表述错误的情况， 如果您在参考的过程中，发现了这样的错误，请您尽量可以告诉我，我会确认并努力修正，如果您对文档有疑问或建议，都可以邮件告知我。在学习过程中受wxhyihuan前辈的启发并参考了他的部分学习笔记 建议您购买原版教材结合本笔记学习，您也可以在网络上找到电子书方便参考，如需求电子版可邮件联系作者。 bookdown 包可以从CRAN 或 Github安装: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) 1.1 软件准备 本文档使用到的主要软件 R version 4.1.0 (2021-05-18) – “Camp Pontanezen,” 和 RStudio 版本是 1.4.1717. 如果您R语言的新手，您可以在下面找到一些快速上手的学习资料： 1.R for Beginners 2.R Markdown: The Definitive Guide sessionInfo() ## R version 4.1.0 (2021-05-18) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 19041) ## ## Matrix products: default ## ## locale: ## [1] LC_COLLATE=Chinese (Simplified)_China.936 ## [2] LC_CTYPE=Chinese (Simplified)_China.936 ## [3] LC_MONETARY=Chinese (Simplified)_China.936 ## [4] LC_NUMERIC=C ## [5] LC_TIME=Chinese (Simplified)_China.936 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] png_0.1-7 jpeg_0.1-8.1 ## ## loaded via a namespace (and not attached): ## [1] bookdown_0.22 digest_0.6.27 magrittr_2.0.1 evaluate_0.14 ## [5] highr_0.9 rlang_0.4.11 stringi_1.6.1 rstudioapi_0.13 ## [9] rmarkdown_2.9 tools_4.1.0 stringr_1.4.0 xfun_0.24 ## [13] yaml_2.2.1 compiler_4.1.0 htmltools_0.5.1.1 knitr_1.33 1.1 图 1.1: 完全随机设计的统计方法选择思路 1.2 致谢 谨以此书献给我的导师范老师！ 1.3 声明 为方便使用，本书保留源代码，如有任何问题请联系作者 921818611@qq.com。 "],["描述.html", "第 2 章 计量资料的统计描述 2.1 数据录入 2.2 计算极差 2.3 计算标准差及四分位数间距 2.4 计算频数分布 2.5 描述性统计的度量 2.6 正态分布和标准正态分布 2.7 正态性检验", " 第 2 章 计量资料的统计描述 描述统计学(广义上的描述统计学,Descriptive statistics)是统计学的一个分支，旨在概括、描述和呈现一系列值或数据集(比如对单样本的分析)。 由于难以识别数据中的任何模式，没有任何准备或没有任何汇总度量的长系列值通常无法提供信息。 描述统计通常是统计分析的第一步，也是统计分析的重要组成部分。它允许通过检测潜在的异常值(即似乎与其他数据分离的数据点)、 收集或编码错误来检查数据的质量。它还有助于“理解”数据，如果表述得当，描述性统计是进一步分析的一个很好的起点。 位置与离散度量是两种不同的总结数据的测量方法。其中一些给出了关于数据位置的理解，另一些给出了关于数据分散性的理解。 在实践中，这两种度量方法经常一起使用，以便以最简洁和完整的方式总结数据。 位置度量允许查看数据位于“何处”，围绕哪个值。换句话说，位置度量可了解什么是总体趋势，即数据整体的“位置”。 它主要包括：平均值，中位数，四分位数，第三、四分位数，众数，最大值，最小值等。 常见的离散度量，它有助于了解离散度和数据的可变性(在何种程度上分布被压缩或拉伸):范围，标准偏差，方差，四分位间距，变异系数。 2.1 数据录入 options (warn = -1)#不显示警告信息 RBC &lt;- c(3.96,4.23,4.42,3.59,5.12,4.02,4.32,3.72,4.76,4.16,4.61,4.26, 3.77,4.20,4.36,3.07,4.89,3.97,4.28,3.64,4.66,4.04,4.55,4.25, 4.63,3.91,4.41,3.52,5.03,4.01,4.30,4.19,4.75,4.14,4.57,4.26, 4.56,3.79,3.89,4.21,4.95,3.98,4.29,3.67,4.69,4.12,4.56,4.26, 4.66,4.28,3.83,4.20,5.24,4.02,4.33,3.76,4.81,4.17,3.96,3.27, 4.61,4.26,3.96,4.23,3.76,4.01,4.29,3.67,3.39,4.12,4.27,3.61, 4.98,4.24,3.83,4.20,3.71,4.03,4.34,4.69,3.62,4.18,4.26,4.36, 5.28,4.21,4.42,4.36,3.66,4.02,4.31,4.83,3.59,3.97,3.96,4.49, 5.11,4.20,4.36,4.54,3.72,3.97,4.28,4.76,3.21,4.04,4.56,4.25, 4.92,4.23,4.47,3.60,5.23,4.02,4.32,4.68,4.76,3.69,4.61,4.26, 3.89,4.21,4.36,3.42,5.01,4.01,4.29,3.68,4.71,4.13,4.57,4.26, 4.03,5.46,4.16,3.64,4.16,3.76)#为方便使用数据，直接以向量方式导入 # Reference a figure by its code chunk label with the `fig:` prefix, e.g., see Figure \\@ref(fig:nice-fig). Similarly, you can reference tables generated from `knitr::kable()`, e.g., see Table \\@ref(tab:nice-tab). matrix_RBC &lt;- matrix(RBC,ncol=11,byrow = T)#转化成矩阵 knitr::kable( head(matrix_RBC,10), caption = &#39;某医院用随机抽样的方法检测了138名正常成年女子的红细胞数目(RBC，x10^12/L )&#39;, booktabs = TRUE)#用表格方式查看矩阵 表 2.1: 某医院用随机抽样的方法检测了138名正常成年女子的红细胞数目(RBC，x10^12/L ) 3.96 4.23 4.42 3.59 5.12 4.02 4.32 3.72 4.76 4.16 4.61 4.26 3.77 4.20 4.36 3.07 4.89 3.97 4.28 3.64 4.66 4.04 4.55 4.25 4.63 3.91 4.41 3.52 5.03 4.01 4.30 4.19 4.75 4.14 4.57 4.26 4.56 3.79 3.89 4.21 4.95 3.98 4.29 3.67 4.69 4.12 4.56 4.26 4.66 4.28 3.83 4.20 5.24 4.02 4.33 3.76 4.81 4.17 3.96 3.27 4.61 4.26 3.96 4.23 3.76 4.01 4.29 3.67 3.39 4.12 4.27 3.61 4.98 4.24 3.83 4.20 3.71 4.03 4.34 4.69 3.62 4.18 4.26 4.36 5.28 4.21 4.42 4.36 3.66 4.02 4.31 4.83 3.59 3.97 3.96 4.49 5.11 4.20 4.36 4.54 3.72 3.97 4.28 4.76 3.21 4.04 4.56 4.25 4.92 4.23 2.2 计算极差 range(RBC) #返回最小值和最大值 ## [1] 3.07 5.46 rge&lt;-max(RBC)-min(RBC)#计算极差 rge ## [1] 2.39 2.3 计算标准差及四分位数间距 #sd()计算标准差，quantile()计算分位数 sd&lt;-sd(RBC) sd ## [1] 0.4457298 quan&lt;-quantile(RBC,c(0.25,0.75)) quan ## 25% 75% ## 3.9625 4.5275 2.4 计算频数分布 breaks &lt;- seq(min(RBC), max(RBC), length.out = 8) RBC_cut &lt;- cut(RBC, breaks, right=T,include.lowest=T) RBC_freq &lt;- table(RBC_cut) table(RBC_cut) ## RBC_cut ## [3.07,3.41] (3.41,3.75] (3.75,4.09] (4.09,4.44] (4.44,4.78] (4.78,5.12] ## 4 17 29 51 23 9 ## (5.12,5.46] ## 5 library(ggplot2) hist_RBC &lt;- ggplot(as.data.frame(RBC), aes(x=RBC)) + geom_histogram(fill=&quot;#69b3a2&quot;,binwidth=0.34) hist_RBC 图 2.1: 红细胞分布直方图 2.5 描述性统计的度量 2.5.1 算术平均值 算术均数简称均值(mean),用于反映组呈对称分布的变量值在数量上的平均水平。 mean(RBC) ## [1] 4.227029 2.5.2 几何平均值 几何均数(geometric mean)可用于反映一组经 对数转换 后呈对称分布的变量值在数量上的平均水平。 exp(mean(log(RBC))) ## [1] 4.203676 2.5.3 变异系数 变异系数(Cefficient of variation，CV)，当进行两个或多个资料变异程度的比较时，如果度量单位与平均数相同， 可以直接利用标准差来比较。如果单位和（或）平均数不同时，比较其变异程度就不能采用标准差， 而需采用标准差与平均数的比值（相对值）来比较。标准差与平均数的比值称为变异系数。 变异系数可以消除单位和（或）平均数不同对两个或多个资料变异程度比较的影响。 sd(RBC)/mean(RBC)*100 ## [1] 10.54475 raster::cv(RBC) ## [1] 10.54475 2.5.4 众数及排序 sort(RBC, decreasing = TRUE) #排序 ## [1] 5.46 5.28 5.24 5.23 5.12 5.11 5.03 5.01 4.98 4.95 4.92 4.89 4.83 4.81 4.76 ## [16] 4.76 4.76 4.75 4.71 4.69 4.69 4.68 4.66 4.66 4.63 4.61 4.61 4.61 4.57 4.57 ## [31] 4.56 4.56 4.56 4.55 4.54 4.49 4.47 4.42 4.42 4.41 4.36 4.36 4.36 4.36 4.36 ## [46] 4.34 4.33 4.32 4.32 4.31 4.30 4.29 4.29 4.29 4.28 4.28 4.28 4.27 4.26 4.26 ## [61] 4.26 4.26 4.26 4.26 4.26 4.25 4.25 4.24 4.23 4.23 4.23 4.21 4.21 4.21 4.20 ## [76] 4.20 4.20 4.20 4.19 4.18 4.17 4.16 4.16 4.16 4.14 4.13 4.12 4.12 4.04 4.04 ## [91] 4.03 4.03 4.02 4.02 4.02 4.02 4.01 4.01 4.01 3.98 3.97 3.97 3.97 3.96 3.96 ## [106] 3.96 3.96 3.91 3.89 3.89 3.83 3.83 3.79 3.77 3.76 3.76 3.76 3.72 3.72 3.71 ## [121] 3.69 3.68 3.67 3.67 3.66 3.64 3.64 3.62 3.61 3.60 3.59 3.59 3.52 3.42 3.39 ## [136] 3.27 3.21 3.07 sort(table(RBC), decreasing = TRUE) #众数 ## RBC ## 4.26 4.36 3.96 4.02 4.2 3.76 3.97 4.01 4.16 4.21 4.23 4.28 4.29 4.56 4.61 4.76 ## 7 5 4 4 4 3 3 3 3 3 3 3 3 3 3 3 ## 3.59 3.64 3.67 3.72 3.83 3.89 4.03 4.04 4.12 4.25 4.32 4.42 4.57 4.66 4.69 3.07 ## 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 ## 3.21 3.27 3.39 3.42 3.52 3.6 3.61 3.62 3.66 3.68 3.69 3.71 3.77 3.79 3.91 3.98 ## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ## 4.13 4.14 4.17 4.18 4.19 4.24 4.27 4.3 4.31 4.33 4.34 4.41 4.47 4.49 4.54 4.55 ## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ## 4.63 4.68 4.71 4.75 4.81 4.83 4.89 4.92 4.95 4.98 5.01 5.03 5.11 5.12 5.23 5.24 ## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ## 5.28 5.46 ## 1 1 2.5.5 其他描述性统计 R语言中，可以使用summary()来计算最小，第1四分位数，中位数，平均值，第3，4分位数和最大值的数据集的所有数值变量。 summary(RBC) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 3.070 3.962 4.230 4.227 4.527 5.460 2.6 正态分布和标准正态分布 正态分布（Normal distribution）又名高斯分布（Gaussian distribution），是一个非常常见的连续概率分布。 正态分布在统计学上十分重要，经常用在自然和社会科学来代表一个不明的随机变量。 可以说，弄懂正态分布是灵活运用统计学中各种假设检验方法、理解p值，均数置信区间的前提。 R包含有很丰富的正态分布相关的函数功能， 比如概率密度函数dnorm()，概率累积分布函数pnorm()，正态分位函数qnorm()和用来生成特定正态分布数据序列的函数rnorm()， 以及检测数据时候符合正态分布的方法，这里主要做下面一些介绍。 2.6.1 概率密度函数dnorm() 概率密度函数（Probability density function），R中即为dnorm()， 它可以给出了指定均值和标准差下每个点的概率分布的高度， 越高就代表着这个点/区间的概率越密集(大)。概率密度函数有时也被称为概率分布函数，但这种称法可能会和累积分布函数pnorm()混淆。 #在-10~10区间等分的 100个 数据集x x &lt;- seq(-10, 10, by = .1) #创建一个均值是2.5，标准差是0.5正态分布 y y &lt;- dnorm(x, mean = 2.5, sd = 0.5) #将 y 中的落在x数据集上的数据画出来 plot(x,y,col=&quot;red&quot;,pch=20) 图 2.2: 概率密度函数示例 #也可以使用ggpubr包中的ggdensity函数直接画概率密度曲线 library(ggpubr) ggdensity(RBC) 图 2.3: ggpubr概率密度函数示例 2.6.2 概率累积分布函数pnorm() 累积分布函数（Cumulative Distribution Function），R中即为pnorm()， 又叫分布函数，是概率密度函数的积分，能完整描述一个实随机变量X的概率分布，它给出一个正态分布中小于一个给定数字的累计概率(即指定定点的左边范围的曲线面积)。 #在-10~10区间等分的 40个 数据集x x &lt;- seq(-10, 10, by = .5) #创建一个均值是2.5，标准差是0.5正态分布 y y &lt;- pnorm(x, mean = 2.5, sd = 0.5) #将 y 中的落在x数据集上的累计概率画出来 plot(x,y,col=&quot;red&quot;,pch=20) 图 2.4: 累积分布密度函数示例 2.6.3 正态分位函数qnorm() #在0~1区间等分的 50个 数据集x x &lt;- x &lt;- seq(0, 1, by = 0.02) #创建一个均值是2，标准差是1正态分布 y y &lt;- qnorm(x, mean = 2, sd = 1) #将 y 中的落在x数据集上的数字画出来 plot(x,y,col=&quot;red&quot;,pch=20) 图 2.5: 正态分布函数示例 2.6.4 生成正态分布函数rnorm() #设置随机种子，便于重复后续的数据选取 set.seed(50) #在标准正态分布中随机选取50个数据 y &lt;- rnorm(50) #对选区的数据绘制频率分布图 hist(y,col=&quot;#A8D6FF&quot;,labels =TRUE) 图 2.6: 正态分布图 2.7 正态性检验 许多计量资料的分析方法要求数据分布是正态或近似正态，因此对原始独立测定数据进行正态性检验是十分必要的。通过绘制数据的频数分布直方图来定性地判断数据分布正态性。 常用正态性检验方法 1.用R语言做正态分布检验 正态性检验主要有三类方法: 计算综合统计量 如动差法、夏皮罗-威尔克Shapiro-Wilk 法(W 检验) 、达戈斯提诺D′Agostino 法(D 检验) 、Shapiro-Francia 法(W′检验)。 正态分布的拟合优度检验 如皮尔逊χ2 检验 、对数似然比检验 、柯尔莫哥洛夫Kolmogorov-Smirov 法检验。 图示法(正态概率图Normal Probability plot) 如分位数图(Quantile Quantileplot ,简称QQ 图) 、百分位数(Percent Percent plot ,简称PP 图) 和稳定化概率图(Stablized Probability plot , 简称SP 图) 等。 统计软件中常用的正态性检验方法 用偏态系数和峰态系数检验数据正态性 偏态系数Sk,它用于检验不对称性;峰态系数Ku,它用于检验峰态。 S k= 0, K u= 0 时, 分布呈正态, S k&gt; 0 时, 分布呈正偏态,S k &lt; 0 时, 分布呈负偏态。适用条件：样本含量应大于200 用夏皮罗-威尔克(Shapiro-Wilk)法检验数据正态性 即W检验,1965 年提出,适用于样本含量n ≤50 时的正态性检;。 用达戈斯提诺(D′Agostino)法检验数据正态性 即D检验,1971提出,正态性D检验该方法效率高，是比较精确的正态检验法。 Shapiro-Francia 法 即W′检验,于1972 年提出,适用于50 &lt; n &lt; 100 时的正态性检验。 QQ图或PP图 散点聚集在固定直线的周围，可以认为数据资料近似服从正态分布 常用的规则： SPSS 规定:当样本含量3 ≤n ≤5000 时,结果以Shapiro - Wilk (W 检验) 为难,当样本含量n &gt; 5000 结果以Kolmogorov - Smirnov 为准。 SAS 规定:当样本含量n ≤2000 时,结果以Shapiro - Wilk (W 检验) 为准,当样本含量n &gt;2000 时,结果以Kolmogorov - Smirnov (D 检验) 为准。 正态性检验最常用的两种正态性检验是Shapiro-Wilk检验（K检验）和Kolmogorov-Smirnov检验（D检验）。两种测试都有相同的假设，即: H0 : 数据服从正态分布 H1 : 数据不服从正态分布 正态性检验推荐使用Shapiro-Wilk检验，因为它比Kolmogorov-Smirnov检验提供更好的效用。 在R中，正态性的Shapiro-Wilk检验可以通过函数shapiro.test()进行 library(nortest) shapiro.test(RBC)#W 检验,我们看到p-value&gt;0.05意味着我们不拒绝数据服从正态分布的原假设。 ## ## Shapiro-Wilk normality test ## ## data: RBC ## W = 0.98908, p-value = 0.3524 ad.test(RBC)#D 检验 ## ## Anderson-Darling normality test ## ## data: RBC ## A = 0.66115, p-value = 0.08262 注意的是，在实践中，正态检验通常被认为过于保守，因为对于大样本(n&gt;50)，对正态条件的一个 小偏差可能会导致违反正态判断的条件。由于正态性检验是一种假设检验，所以随着样本量的增加，其检测较小差 异的能力也会增加。因此，随着观测数的增加，Shapiro-Wilk检验变得非常敏感，甚至对正态性的一个 微小偏差也非常敏感。所以，根据正态性检验，数据不服从正态分布，尽管偏离正态分布的情况可以忽略不计，但数据 实际上服从正态分布。因此，通常情况下，正态性条件的验证是基于本文所介绍的所有方法的组合，即目视检验 (使用直方图和q-q图)和正式化检验(例如使用shapio-wilk检验)。 参考： 刘庆武,胡志艳，如何用SPSS、SAS 统计软件进行正态性检验，湘南学院学报(自然科学版)，2005 朱红兵，何丽娟，在SPSS10.0 中进行数据资料正态性检验的方法，首都体育学院学报，2004 "],["推论统计.html", "第 3 章 推论统计 3.1 统计量与标准误", " 第 3 章 推论统计 推论统计（或称统计推断，Statistical inference），指统计学中，研究如何根据样本数据去推断总体数量特征的方法。 它是在对样本数据进行描述的基础上，对统计总体的未知数量特征做出以概率形式表述的推断。更概括地说， 是在一段有限的时间内，通过对一个随机过程的观察来进行推断的。统计学中，统计推断与描述统计相对应。 推论统计(Statistical inferences)是借助抽样调查，从局部推断总体，以对不肯定的事物做出决策的一种统计。 有总体参数估计与假设检验两种。前者以一次性抽样实验为依据，对整个总体的某个数字特征做出估计。后者则是对 某种假设进行检验，根据计算结果推断所做的假设是否可以接受。如平均数、标准差、相关系数、回归系数等特征的 总体估计及差异显著性检验。推断统计的理论基础是概率论，它更多地需要借助抽样理论与方法。 ## 参数估计与假设检验 参数估计背后的思想是通过对从总体中抽取的样本进行统计显著性检验(如t检验)，为研究人员提供关于总体的统计推断。 最常用的就是t检验，其参数检验是基于W.S.Gosset的t统计量，该统计数据假设变量来自正态总体。t检验统计量中的总体均值是已知的。 这种分布称为t分布，其形状与正态分布类似，即钟形曲线。t检验用于检验那些样本小于30的样本比正态分布要好， 在大样本上做的和正态分布一样好。 假设检验(Hypothesis test)过去也叫做显著性检验(Significance test)，是利用小概率反证法思想，从问题的对立面(H0 )出发， 间接判断解决问题(H1 )是否成立。即在假设H0 成立的条件下，计算检验统计量(Test static)，然后根据P 值(P-value)来判断。 3.1 统计量与标准误 样本是总体的代表和反映，也是统计推断的依据，为了对总体的分布或数字特征进行各种统计推断，还需要对样本作加工处理， 把样本中应关心的事物和信息集中起来，针对不同的问题构造出样本的不同函数(如均值，方差，极差，标准差，中位数，众数等)，这种样本的函数我们称其为统计量。 样本统计量的标准差即为标准误(Stand error,SE)，反映了抽样的统计量的离散程度或误差大小。如样本均数的标准差也称为均数标准误 (Stand error of mean, SEM)，反映了样本均数的离散程度。 "],["t-分布.html", "第 4 章 t 分布", " 第 4 章 t 分布 "],["methods.html", "第 5 章 Methods", " 第 5 章 Methods We describe our methods in this chapter. "],["applications.html", "第 6 章 Applications 6.1 Example one 6.2 Example two", " 第 6 章 Applications Some significant applications are demonstrated in this chapter. 6.1 Example one 6.2 Example two "],["final-words.html", "第 7 章 Final Words", " 第 7 章 Final Words We have finished a nice book. "],["references.html", "References", " References "]]
